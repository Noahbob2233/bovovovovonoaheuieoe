version: '3.2'

services:
  rpnow:
    volumes:
      - ./client/dist:/root/client/dist:ro
      - ./server/src:/root/server/src:ro
      - ./server/admin:/root/server/admin:ro
      - ./server/jasmine.json:/root/server/jasmine.json:ro
      - ./server/package.json:/root/server/package.json:ro
      - ./server/package-lock.json:/root/server/package-lock.json:ro
    command: npm run start-dev

  db:
    networks:
      - admin-layer

  sql:
    networks:
      - admin-layer
    ports:
      - "3306:3306"

  db_debug:
    image: "mongo-express:latest"
    depends_on:
      - db
    environment:
      ME_CONFIG_MONGODB_SERVER: db
    ports:
      - "8282:8081"
    networks:
      - admin-layer

  sql_debug:
    image: "adminer"
    depends_on:
      - sql
    environment:
      ADMINER_DESIGN: "pepa-linha"
    ports:
      - "8383:8080"
    networks:
      - admin-layer

networks:
  admin-layer:
